# 草药问答系统 - 项目总览

## 🎯 项目概述

草药问答系统是一个专为移动端设计的中草药知识学习和测试平台。用户可以通过随机抽题的方式学习草药知识，系统会记录用户的答题情况并提供详细的统计分析。

## 📊 核心功能模块

### 1. 用户认证模块

- **注册**: 用户名、密码、昵称
- **登录**: JWT Token 认证
- **登出**: 清除认证状态
- **个人信息**: 查看和修改用户资料

### 2. 题目管理模块

- **随机抽题**: 从题库中随机抽取题目
- **难度筛选**: 简单、中等、困难三个等级
- **分类筛选**: 按中草药分类（补益药、清热药等）
- **题目详情**: 题目文本、四个选项、正确答案、详细解析

### 3. 答题功能模块

- **答题提交**: 提交用户选择的答案
- **即时反馈**: 显示答案是否正确
- **详细解析**: 展示正确答案和知识点解析
- **统计更新**: 自动更新用户答题统计

### 4. 统计分析模块

- **累计答题数**: 用户总共答过的题目数量
- **正确题数**: 答对的题目数量
- **正确率**: 动态计算的正确率百分比
- **连续学习天数**: 记录用户连续学习的天数
- **每周统计**: 最近 7 天的答题情况统计

### 5. 历史记录模块

- **答题历史**: 查看所有答题记录
- **分页加载**: 支持下拉刷新和上拉加载更多
- **详情回顾**: 查看历史题目的答案和解析
- **时间排序**: 按答题时间倒序显示

## 🗄️ 数据库设计

### 表结构说明

#### users (用户表)

| 字段          | 类型         | 说明           |
| ------------- | ------------ | -------------- |
| id            | INT          | 主键           |
| username      | VARCHAR(50)  | 用户名（唯一） |
| password_hash | VARCHAR(255) | 加密密码       |
| nickname      | VARCHAR(50)  | 昵称           |
| avatar        | VARCHAR(255) | 头像 URL       |
| created_at    | TIMESTAMP    | 创建时间       |
| updated_at    | TIMESTAMP    | 更新时间       |

#### questions (题目表)

| 字段           | 类型         | 说明                   |
| -------------- | ------------ | ---------------------- |
| id             | INT          | 主键                   |
| question_text  | TEXT         | 题目内容               |
| option_a       | VARCHAR(255) | 选项 A                 |
| option_b       | VARCHAR(255) | 选项 B                 |
| option_c       | VARCHAR(255) | 选项 C                 |
| option_d       | VARCHAR(255) | 选项 D                 |
| correct_answer | ENUM         | 正确答案(A/B/C/D)      |
| explanation    | TEXT         | 题目解析               |
| difficulty     | ENUM         | 难度(easy/medium/hard) |
| category       | VARCHAR(50)  | 分类                   |

#### answer_records (答题记录表)

| 字段        | 类型      | 说明              |
| ----------- | --------- | ----------------- |
| id          | INT       | 主键              |
| user_id     | INT       | 用户 ID（外键）   |
| question_id | INT       | 题目 ID（外键）   |
| user_answer | ENUM      | 用户答案(A/B/C/D) |
| is_correct  | BOOLEAN   | 是否正确          |
| answered_at | TIMESTAMP | 答题时间          |

#### user_statistics (用户统计表)

| 字段            | 类型    | 说明            |
| --------------- | ------- | --------------- |
| id              | INT     | 主键            |
| user_id         | INT     | 用户 ID（外键） |
| total_questions | INT     | 总题数          |
| correct_answers | INT     | 正确数          |
| accuracy_rate   | DECIMAL | 正确率          |
| last_study_date | DATE    | 最后学习日期    |
| continuous_days | INT     | 连续天数        |

### 关系说明

- 用户 ↔ 答题记录: 一对多
- 用户 ↔ 用户统计: 一对一
- 题目 ↔ 答题记录: 一对多

## 🔐 API 接口设计

### 认证接口 (/api/auth)

- `POST /register` - 用户注册
- `POST /login` - 用户登录
- `GET /me` - 获取当前用户
- `POST /logout` - 用户登出

### 题目接口 (/api/questions)

- `GET /random` - 获取随机题目
- `GET /{id}` - 获取指定题目
- `POST /{id}/answer` - 提交答案
- `GET /categories` - 获取题目分类
- `GET /list` - 获取题目列表（分页）

### 用户接口 (/api/user)

- `GET /profile` - 获取用户资料
- `PUT /profile` - 更新用户资料
- `GET /statistics` - 获取统计信息
- `GET /history` - 获取答题历史（分页）
- `GET /statistics/weekly` - 获取每周统计

## 🎨 前端页面结构

### 1. 登录页 (Login.vue)

- 用户名/密码输入
- 登录按钮
- 注册入口

### 2. 注册页 (Register.vue)

- 用户名/昵称/密码输入
- 密码确认
- 表单验证
- 注册按钮

### 3. 首页 (Home.vue)

- **统计卡片**: 显示总题数、正确数、正确率、连续学习天数
- **开始答题**: 随机抽题按钮
- **分类选择**: 按草药分类答题
- **难度选择**: 按难度答题
- **底部导航**: 首页、历史、我的

### 4. 答题页 (Question.vue)

- **题目信息**: 难度标签、分类标签、题目文本
- **选项区域**: 四个单选选项（答题前）
- **答案解析**: 正确/错误提示、正确答案、详细解析（答题后）
- **下一题按钮**: 继续答题

### 5. 历史记录页 (History.vue)

- **列表展示**: 答题记录列表
- **时间显示**: 相对时间（几分钟前、几小时前等）
- **答案对比**: 用户答案 vs 正确答案
- **题目解析**: 展开查看解析
- **下拉刷新**: 刷新列表
- **上拉加载**: 加载更多记录

### 6. 个人中心页 (Profile.vue)

- **用户信息**: 用户名、昵称、注册时间
- **学习统计**: 累计答题、正确题数、正确率、连续学习
- **功能菜单**: 修改昵称、清除缓存、关于我们
- **退出登录**: 退出当前账号

## 🔄 数据流程

### 答题流程

```
1. 用户点击"开始答题"
   ↓
2. 前端调用 GET /api/questions/random
   ↓
3. 后端从数据库随机查询一道题目
   ↓
4. 前端展示题目和选项
   ↓
5. 用户选择答案并提交
   ↓
6. 前端调用 POST /api/questions/{id}/answer
   ↓
7. 后端判断答案是否正确
   ↓
8. 后端创建答题记录
   ↓
9. 后端更新用户统计信息
   ↓
10. 前端展示结果和解析
```

### 统计更新流程

```
1. 用户提交答案
   ↓
2. 创建答题记录（answer_records表）
   ↓
3. 更新用户统计（user_statistics表）
   - total_questions + 1
   - 如果正确: correct_answers + 1
   - 重新计算 accuracy_rate
   - 更新 last_study_date
   - 更新 continuous_days
```

## 🎯 技术亮点

### 后端

1. **Flask 应用工厂模式**: 便于测试和扩展
2. **蓝图组织路由**: 模块化设计
3. **JWT 认证**: 无状态认证，适合移动端
4. **ORM 模型**: SQLAlchemy 简化数据库操作
5. **环境变量配置**: 安全管理敏感信息

### 前端

1. **Vue 3 Composition API**: 更好的逻辑复用
2. **Pinia 状态管理**: 轻量级、TypeScript 友好
3. **Vant 组件库**: 专业的移动端 UI 组件
4. **路由守卫**: 统一的权限控制
5. **Axios 拦截器**: 统一的请求/响应处理
6. **响应式设计**: 完美适配各种手机屏幕

### 移动端优化

1. **触摸友好**: 大按钮、易点击
2. **底部导航**: 符合移动端操作习惯
3. **下拉刷新**: 原生般的体验
4. **即时反馈**: 快速的交互响应
5. **渐进式加载**: 分页加载优化性能

## 📦 部署架构

```
┌─────────────┐
│   用户端    │
│  (浏览器)   │
└──────┬──────┘
       │ HTTP/HTTPS
       ↓
┌─────────────┐
│   Nginx     │  静态文件服务 + 反向代理
└──────┬──────┘
       │
       ├→ /          → 前端静态文件 (Vue)
       │
       └→ /api/*     → 后端 API (Flask)
                        ↓
                   ┌──────────┐
                   │  MySQL   │
                   │ 数据库   │
                   └──────────┘
```

## 🚀 扩展建议

### 功能扩展

1. **题目收藏**: 收藏难题或重点题目
2. **错题本**: 专门练习错题
3. **学习计划**: 制定学习目标和计划
4. **排行榜**: 用户排名系统
5. **题目推荐**: 基于学习情况智能推荐
6. **社交功能**: 好友系统、学习打卡分享
7. **成就系统**: 勋章、徽章激励

### 技术优化

1. **Redis 缓存**: 缓存热点数据
2. **搜索功能**: Elasticsearch 全文搜索
3. **消息队列**: 异步处理统计更新
4. **数据分析**: 用户学习行为分析
5. **推送通知**: 学习提醒
6. **多端适配**: 小程序、App

## 📝 维护建议

### 日常维护

1. 定期备份数据库
2. 监控系统日志
3. 更新依赖包
4. 性能监控和优化
5. 用户反馈收集

### 内容维护

1. 定期添加新题目
2. 审核题目质量
3. 更新题目解析
4. 分类整理题目

## 📞 技术支持

如有问题，请查看：

- [README.md](../README.md) - 项目介绍
- [QUICKSTART.md](../QUICKSTART.md) - 快速开始
- [docs/API.md](../docs/API.md) - API 文档
- [docs/DEPLOY.md](../docs/DEPLOY.md) - 部署文档
- [docs/DEV.md](../docs/DEV.md) - 开发指南
